#
# Makefile for CGIWrap
# This file is automatically generated from Makefile.in
#

#
# Compiler definitions and flags
#
srcdir=@srcdir@
VPATH=@srcdir@
@SET_MAKE@
CC=@CC@ 
CFLAGS=@CFLAGS@ -I. -I$(srcdir) @CPPFLAGS@ @AFSCFLAGS@
LDFLAGS=@LDFLAGS@ @AFSLDFLAGS@
LIBS=@AFSLIBS@ @LIBS@

#
# Object Files
#
OBJS=cgiwrap.o debug.o util.o fetch.o stdutil.o msgs.o

#
# Dependencies for building cgiwrap
#
all: cgiwrap

.c.o: cgiwrap.h config.h Makefile
	$(CC) -c $(CCFLAGS) $<

install: cgiwrap
	@DOINSTALL@ rm -f @INSTALLDIR@/cgiwrap
	@DOINSTALL@ rm -f @INSTALLDIR@/cgiwrapd
	@DOINSTALL@ rm -f @INSTALLDIR@/nph-cgiwrap
	@DOINSTALL@ rm -f @INSTALLDIR@/nph-cgiwrapd
	@DOINSTALL@ cp $(srcdir)/cgiwrap @INSTALLDIR@/cgiwrap
	@DOINSTALL@ chown root @INSTALLDIR@/cgiwrap
	@DOINSTALL@ chgrp @INSTALLGROUP@ @INSTALLDIR@/cgiwrap
	@DOINSTALL@ chmod @INSTALLMODE@ @INSTALLDIR@/cgiwrap
	@DOINSTALL@ ln @INSTALLDIR@/cgiwrap @INSTALLDIR@/cgiwrapd
	@DOINSTALL@ ln @INSTALLDIR@/cgiwrap @INSTALLDIR@/nph-cgiwrap
	@DOINSTALL@ ln @INSTALLDIR@/cgiwrap @INSTALLDIR@/nph-cgiwrapd

cgiwrap: config.h $(OBJS)
	$(CC) $(OBJS) $(LDFLAGS) $(LIBS) -o cgiwrap

clean:
	rm -f cgiwrap core *~ *.o *.tar Makefile.bak

distclean: clean
	rm -f config.cache config.log config.h config.status Makefile
	rm -f unsup/loganalyze.pl

#
# Source file dependencies
#
cgiwrap.o: config.h cgiwrap.h cgiwrap.c
debug.o: config.h cgiwrap.h debug.c
util.o: config.h cgiwrap.h util.c
fetch.o: config.h cgiwrap.h fetch.c
stdutil.o: config.h cgiwrap.h stdutil.c
msgs.o: config.h cgiwrap.h msgs.c

#
# Dependencies for developing cgiwrap
#
VERSION=3.6beta4

allconf: configure config.h.in Makefile config.h

configure: configure.in
	autoconf

Makefile: Makefile.in
	./config.status

config.h.in: acconfig.h
	autoheader

config.h: config.h.in
	./config.status

docs: Makefile
	for p in htdocs/*.html; do \
		lynx -nolist -dump $$p > doc/`basename $$p .html`; \
	done

dist:
	rm -rf ../cgiwrap-$(VERSION)
	mkdir ../cgiwrap-$(VERSION)
	touch * */*
	cp -r * ../cgiwrap-$(VERSION)
	cd ../cgiwrap-$(VERSION) && make distclean
	cd ../cgiwrap-$(VERSION) && rm -rf CVS */CVS */*/CVS
	cd ../cgiwrap-$(VERSION) && rm -rf .cvsignore */.cvsignore */*/.cvsignore
	cd ../cgiwrap-$(VERSION) && rm -rf RCS */RCS */*/RCS
	cd ../cgiwrap-$(VERSION) && rm -rf doc U

tardist: dist
	gtar -C .. -czvf ../cgiwrap-$(VERSION).tar.gz cgiwrap-$(VERSION)
	#pgp -sba ../cgiwrap-$(VERSION).tar.gz
	rm -f ../cgiwrap-$(VERSION).tar.gz.sig
	#mv ../cgiwrap-$(VERSION).tar.gz.asc ../cgiwrap-$(VERSION).tar.gz.sig
	
commit: configure config.h.in docs
	cvs commit -m "" .
